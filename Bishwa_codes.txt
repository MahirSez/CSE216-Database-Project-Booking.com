
---DROP PROPERTY_ID
ALTER TABLE HOTEL
DROP COLUMN PROPERTY_ID;

---CHANGE DESCRIPTION
ALTER TABLE HOTEL 
RENAME COLUMN DESCRIPTIO TO DESCRIPTION;


---RETURNS HOTEL_ID FROM HOTEL NAME ( ASSUMES ONE CITY_NAME HAS ONE ID)

CREATE OR REPLACE FUNCTION GET_HOTEL_ID(NAME VARCHAR)
RETURNS INTEGER AS $$

DECLARE 
	H_ID INTEGER;
BEGIN
	SELECT HOTEL_ID INTO H_ID
	FROM HOTEL
	WHERE HOTEL_NAME = NAME;
	RETURN H_ID;
END;
$$ LANGUAGE PLpgSQL;






---TRIGGER FOR PROPERTY THAT WILL CALL HOTEL INSERT ( CAR NOT HANDLED)

CREATE OR REPLACE FUNCTION PROP_INS_HOTEL_INS()
	RETURNS TRIGGER AS $$
BEGIN
     
     IF NEW.PROPERTY_TYPE = 'hotel' THEN
     	INSERT INTO public.hotel(
            hotel_id, hotel_name, description, rating)
    		VALUES (NEW.PROPERTY_ID, 'HASINA', 'BAALER HOTEL', 5);
     
     ELSEIF NEW.PROPERTY_TYPE = 'car_rental' THEN
     	INSERT INTO public.hotel(
            company_id)
    		VALUES (NEW.PROPERTY_ID);
     END IF;
     RETURN NEW;
END
$$ LANGUAGE PLpgSQL

DROP TRIGGER IF EXISTS PROP_INS_HOTEL_INS_TRIG
  ON public.PROPERTY;
CREATE TRIGGER PROP_INS_HOTEL_INS_TRIG
AFTER INSERT 
ON PROPERTY
FOR EACH ROW
EXECUTE PROCEDURE PROP_INS_HOTEL_INS();


---INSERT SOME INFOS
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 7 , 9);
insert into property(property_type , owner_id , city_id) VALUES('car' , 7 , 10);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 8 ,11);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 8 , 12);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 8 , 9);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 8 , 10);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 8 , 11);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 8 , 12);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 9 , 9);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 9 , 10);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 9 , 11);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 9 , 12);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 9 , 9);
insert into property(property_type , owner_id , city_id) VALUES('hotel' , 9 , 10);

---RETURNS DESCRIPTION(TEXT) TAKING HOTEL_ID

CREATE OR REPLACE FUNCTION GET_HOTEL_DESCRIPTION(H_ID INTEGER)
RETURNS TEXT AS $$
DECLARE 
	DES TEXT;
BEGIN
	SELECT DESCRIPTION INTO DES 
	FROM  HOTEL 
	WHERE HOTEL_ID = H_ID;
	RETURN DES;
END;
$$ LANGUAGE PLpgSQL;


---RETURNS NUBMERS OF ROOMS OF EACH TYPE FROM A HOTEL 

CREATE OR REPLACE FUNCTION GET_